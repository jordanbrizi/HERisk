<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Results</title>
	<link rel="stylesheet" type="text/css" href="./css/app.css">
</head>

<body>
<main>
	<button type="button" class="main-button" id="close_button"></button>
	<header class="pb-3 sticky-top page">
		<div class="container-fluid pt-3">
			<h1 class="m-0 user-select-none" id="logo">hh<b>risk</b>/resultados</h1>
		</div>
	</header>

	<section class="over">
		<div class="container-fluid" id="resultados">
			<div id="loading" class="spinner-border text-light" style="display: none; width: 4rem; height: 4rem;" role="status">
				<span class="sr-only">Loading...</span>
			</div>
		</div>
	</section>

	<footer class="fixed-bottom">
		<div class="container-fluid">
			<p class="pt-3 user-select-none" onclick="location.reload()">
				&copy; 2020 - <span class="year"></span>. <span data-lang="all_rights"></span>. <span class="app_version"></span>
			</p>
		</div>
	</footer>
</main>
<script>
	console.log(`Resultados.html\n`)
	const rend = require('./renderer.js')
	const $ = arg => document.querySelector(arg)
	const $$ = arg => document.querySelectorAll(arg)

	d = new Date()
	$('.year').innerHTML = d.getFullYear()

	$('#close_button').addEventListener('click', () => {
		rend.ipcRenderer.send('resultados')
	})
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
const Render = () => {
	const dados = rend.Dados()
	
	for(q = 0; q < dados.quantidade(); q++) {
		const tables = dados.pegar(dados.arquivo(q))
		const DadosKey = Object.keys(tables)
		DadosKey.forEach(pai => {
			var caption = document.createElement('h3')
			caption.classList = 'mt-3 mb-3 text-center'
			caption.innerHTML = pai
	
			var tabela = document.createElement('table')
			tabela.id = pai
			tabela.classList = 'table table-sm text-white'
	
			var thead = document.createElement('thead')
			var tbody = document.createElement('tbody')
			tabela.appendChild(thead)
			$('#resultados').appendChild(caption)
	
			// GERAR OS TH'S DAS TABELAS -------------------------------------------
				
			var titulos = Object.keys(tables[pai][0])
			var tr = document.createElement('tr')
			titulos.forEach(t => {
				let th = document.createElement('th')
				th.scope = "col"
				th.innerHTML = t
				$('#resultados').appendChild(tabela).appendChild(thead)
					.appendChild(tr).appendChild(th)
			})
			
			//----------------------------------------------------------------------
			
			tables[pai].forEach(filho => {
				var tr = document.createElement('tr')
				let td = document.createElement('td')
				d = []
				for(var t = 0; t < titulos.length; t++) {
					d.push(`<td>${filho[titulos[t]]}</td>`)
				}
				tr.innerHTML = d.join('')
	
				$('#resultados').appendChild(tabela).appendChild(tbody)
					.appendChild(tr)
			})
		})
	}


}

Render()

</script>
</body>
</html>